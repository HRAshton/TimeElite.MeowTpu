"use strict";!function(){var e=window.$,n=1;e("document").on("load",function(){e(".today")[0]&&e(".today")[0].scrollIntoView()}),e("#clear-legend").on("click",function(){e("#legend-show-block").css("display","none"),e("#legend-edit-block").css("display","inline-flex"),e(".events").each(function(n,t){return e(t).children().remove()}),document.cookie="link=; expires=Thu, 01 Jan 1970 00:00:01 GMT;"}),e("form").on("submit",function(n){var t="0;0;"+e("#selector").selectize().val()+";";return document.location.href="/?"+t,n.preventDefault(),!1}),e("#save-legend").on("click",function(){e("form").submit()});const t=e("#generate-ical-btn");t.on("click",function(){t.disabled=!0,t.html('<img class="spinner" style="width: 24px; height: 24px" src="/images/loading.svg"/>');const n=document.location.search.replace("?","");n.includes(";1;")&&alert('Внимание\r\nЕсли включен режим "Показывать окна", то в календаре они тоже отобразятся'),fetch("/Api/GenerateIcalLink?"+n).then(function(n){n.text().then(function(n){const i=e("#ical-link");t.hide(),i.show(),i.val(n)})})}),e(".event").each(function(n,t){const i=e(t).data("hideid"),c=window.location.href;e(t).on("click",function(){c.includes(i)?window.location.href=window.location.href.replace(i,"").replace(",,",","):window.location.href+=i+","})}),e("#next-page").on("click",function(){e("#matrix").empty(),e("#matrix").append('<img class="spinner" src="/images/loading.svg"/>');const t=document.location.search.replace("?","");fetch("/GetElementsForWeek?"+ ++n+";"+t).then(function(n){n.text().then(function(n){e("#matrix").empty(),e("#matrix").append(n)})})}),e("#selector").selectize({valueField:"hash",labelField:"title",searchField:"html",maxItems:12,create:!1,score:function(e){return function(e){return 1}},render:{option:function(e,n){return"<div>"+e.html+"</div>"}},load:function(n,t){if(!n.length)return t();e.ajax({url:window.location.origin+"/api/Search?query="+encodeURIComponent(n),type:"GET",error:function(){t()},success:function(n){e("#selector").selectize()[0].selectize.clearOptions(),t(n)}})}})}();